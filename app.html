<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Advanced Fuzzing Interface</title>
  <style>
    body {
      margin: 0; background: #0a0a0a; color: #0ff; font-family: monospace;
    }
    header {
      background: #000; padding: 15px; text-align: center;
      font-size: 24px; color: #0ff; position: relative;
    }
    #logoutBtn {
      position: absolute; left: 10px; top: 10px;
      background: #0ff; color: #000; border: none;
      padding: 5px 10px; border-radius: 5px; cursor: pointer;
    }
    .container {
      display: flex; padding: 20px; gap: 20px;
    }
    .left, .right {
      flex: 1;
    }
    textarea, input, button {
      width: 100%; background: #000; color: #0ff; border: 1px solid #0ff;
      margin-bottom: 10px; padding: 8px; border-radius: 5px;
    }
    #regions {
      margin-top: 10px;
    }
    iframe {
      width: 100%; height: 300px; border: 1px solid #0ff; margin-top: 20px;
    }
    .terminal {
      background: #000; color: #0f0; border: 1px solid #0ff;
      height: 300px; overflow-y: scroll; padding: 10px;
      margin-top: 20px; white-space: pre-wrap;
    }
  </style>
</head>
<body style="display:none;">
  <div id="loginScreen" style="position: fixed; top:0; left:0; width:100vw; height:100vh; background:#000; display:flex; flex-direction:column; justify-content:center; align-items:center; z-index:999;">
    <h2>Please enter the password</h2>
    <input type="password" id="passwordInput" placeholder="Password">
    <button onclick="checkPassword()">Login</button>
  </div>

  <header>
    <button id="logoutBtn" onclick="logout()">Logout</button>
    kader11000 - Advanced Hacking Dashboard
  </header>

  <div class="container">
    <div class="left">
      <input type="text" id="targetUrl" placeholder="Enter target URL (e.g., https://example.com)">
      <textarea id="rawRequest" rows="10" placeholder="Paste raw HTTP request here..."></textarea>
      <button onclick="extractRegions()">Extract Brute-force Regions</button>
      <div id="regions"></div>
      <button onclick="startFuzzing()">Start Fuzzing</button>
    </div>
    <div class="right">
      <iframe id="responseFrame"></iframe>
      <div class="terminal" id="terminalLog">[+] Waiting to start fuzzing...</div>
    </div>
  </div>

  <script>
    function checkPassword() {
      if (document.getElementById('passwordInput').value === 'kader11000') {
        document.getElementById('loginScreen').style.display = 'none';
        document.body.style.display = 'block';
      } else {
        alert('Incorrect password');
      }
    }

    function logout() {
      document.body.style.display = 'none';
      document.getElementById('loginScreen').style.display = 'flex';
      document.getElementById('passwordInput').value = '';
    }

    function extractRegions() {
      const req = document.getElementById("rawRequest").value;
      const matches = [...req.matchAll(/{{(.*?)}}/g)];
      const container = document.getElementById("regions");
      container.innerHTML = '';
      matches.forEach((m, i) => {
        const div = document.createElement('div');
        div.innerHTML = `
          <label>${m[1]}: <input type="file" onchange="handleFile(event, '${m[1]}')"></label>
        `;
        container.appendChild(div);
      });
    }

    const wordlists = {};
    function handleFile(event, regionName) {
      const reader = new FileReader();
      reader.onload = () => {
        wordlists[regionName] = reader.result.split(/\\r?\\n/);
        logTerminal("[*] Loaded wordlist for " + regionName + ": " + wordlists[regionName].length + " entries");
      };
      reader.readAsText(event.target.files[0]);
    }

    function startFuzzing() {
      const raw = document.getElementById("rawRequest").value;
      const url = document.getElementById("targetUrl").value;
      const keyword = prompt("Enter success keyword to match in response:");
      const frame = document.getElementById("responseFrame");
      const combos = buildCombos(Object.values(wordlists));

      if (!combos.length) {
        alert("No combinations to fuzz!");
        return;
      }

      logTerminal(`[+] Starting fuzzing on ${url} with ${combos.length} combinations`);

      let index = 0;
      const loop = setInterval(() => {
        if (index >= combos.length) return clearInterval(loop);

        let request = raw;
        Object.keys(wordlists).forEach((key, i) => {
          request = request.replace(`{{${key}}}`, combos[index][i]);
        });

        // simulate response & match keyword
        const fakeResponse = "Fake response with " + combos[index].join("-");
        logTerminal("[>] Trying: " + combos[index].join(" | "));

        if (fakeResponse.includes(keyword)) {
          logTerminal("[!] Match found: " + combos[index].join(" | "));
          frame.srcdoc = "<pre>" + fakeResponse + "</pre>";
          clearInterval(loop);
          saveResult(url, request, keyword);
        }
        index++;
      }, 500);
    }

    function buildCombos(arrays) {
      if (arrays.length === 0) return [];
      return arrays.reduce((acc, curr) => acc.flatMap(a => curr.map(b => a.concat([b]))), [[]]);
    }

    function logTerminal(msg) {
      const log = document.getElementById("terminalLog");
      log.textContent += "\\n" + msg;
      log.scrollTop = log.scrollHeight;
    }

    function saveResult(url, request, keyword) {
      const blob = new Blob([`
        <html><body style='background:#000;color:#0f0;font-family:monospace'>
        <h2>Success Result</h2>
        <p><b>URL:</b> ${url}</p>
        <p><b>Matched Keyword:</b> ${keyword}</p>
        <pre>${request}</pre>
        </body></html>
      `], { type: "text/html" });

      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "result/success.html";
      a.click();
    }
  </script>
</body>
</html>
